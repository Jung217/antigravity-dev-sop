---
name: antigravity-dev-sop
description: 強調「策略先行」與「自我驗證」的 AI 協作規範。強制執行繁體中文環境、環境變數隔離及 Git 現況感知，並以 Agent Loop 迭代方式完成 MVP 核心功能。
---

## 語言偏好
- **回應語言**：請一律使用**繁體中文**回應我的問題和請求
- **程式碼註解**：在撰寫程式碼時，所有註解請使用**繁體中文**
- **文件內容**：建立或編輯文件檔案（如 README.md、說明文件等）時，請使用**繁體中文**撰寫
- **變數命名**：程式碼中的變數、函數名稱等仍使用英文（遵循程式設計慣例），但相關說明使用繁體中文

## 程式開發規範
- **功能完整性與穩定性**：
  在實作或修改特定功能時，**不應僅驗證當前功能**是否運作正常，必須同時考量並確保**現有其他功能不受影響**（避免產生 Side Effects 或破壞既有邏輯）。
  - 若修改可能影響共用模組，請特別標註並檢查相關聯的程式碼。

## Git 操作規範
- **環境現況優先 (Context Awareness)**：
  - 在生成任何與遠端互動的指令（如 `push`, `pull`, `fetch`）之前，**必須**先確認當前 Git 設定。
  - **禁止猜測 Remote 與 Branch**：絕對禁止假設 remote 名稱為 `origin` 或分支為 `main`/`master`。若不確定，請先執行 `git remote -v` 和 `git branch --show-current` 獲取真實資訊。
- **提交與發布管制**：
  - **禁止過早提交**：在功能代碼未完善或未經測試前，禁止主動建議 `git add` 或 `git commit`，以免汙染版控紀錄。
  - **發布前檢驗**：在執行 `push` 前，必須明確指出目標 Remote 與 Branch，並確保該目標存在於上述的檢查結果中。
  - **Commit撰寫規則**:必須列出修改項目及功能描述，使用繁體中文撰寫

## 安全與配置規範
- **敏感資訊隔離**：
  - 嚴禁將敏感資訊（如 API Key、資料庫密碼、Secret Key）硬編碼（Hardcode）在程式碼中。
  - 必須強制使用環境變數（Environment Variables）或 `.env` 檔案管理。
- **可配置性設計**：
  - 易變動參數（如 PORT、Database Host、外部服務 URL）應設為可配置變數，而非寫死在邏輯中。

## 部署與運維規範
- **進程管理優先**：
  - 在設計後端服務或長期運行的腳本時，優先考量使用進程管理工具（如 PM2）的配置，而非僅提供 `node app.js` 指令。
  - 需考慮日誌管理、自動重啟與叢集模式（Cluster Mode）的支援性。
- **啟動腳本標準化**：
  - 在 `package.json` 或專案文件中，需明確定義標準化的啟動（start）、開發（dev）與建置（build）指令。

## 解決方案設計流程
- **策略優先於實作**：
  - 當面對複雜系統開發（如建立 API、完整前端頁面）時，**請勿直接給出最終程式碼**。
  - **第一步**：先提出 2-3 種技術架構或實作策略，並分析優缺點。
  - **第二步**：建議一個「最小可行方案（MVP）」，經確認後再開始撰寫細節程式碼。
- **自我驗證迴圈**：
  - 在輸出完成的程式碼前，必須進行「自我模擬執行」：
    1. 檢查核心需求是否滿足。
    2. 檢查是否符合上述的安全與配置規範。
    3. 檢查前後端串接邏輯（如 CORS、Port 對應）是否正確。

## 其他偏好
（您可以在此新增其他常用的偏好設定）
請以「探索式 Agent Loop 模式」執行以下任務，並全程使用繁體中文。
# 探索與執行流程 (Exploration & Execution Flow)
請依循以下步驟進行迭代，**切勿直接給出完整程式碼**：

1. **需求分析與策略擬定 (Analyze & Strategize)**：
   - **Step 1**：分析我的任務目標，拆解出核心功能 (MVP)。
   - **Step 2**：提出 **2-3 種可行的實作策略** 
     - *範例：方案 A 是簡單版，方案 B 是包含權限管理的完整版。*
   - **Step 3**：分析各方案優缺點，並建議一個「最小可行方案 (MVP)」讓我確認。


2. **迭代實作 (Iterative Implementation)**：
 
   - **自我修正 Loop**：
     - 每寫完一個功能，自動檢查是否可運作。
     - 若報錯 (Error)，請讀取 Log -> 分析原因 -> 修正程式碼 -> 重新驗證。

# Agent Loop 規則
- **環境變數優先**：遇到連線資訊，優先檢查是否已寫入設定檔。
- **繁體中文**：所有註解、文件、UI 提示文字皆需使用繁體中文。
- **最大迭代次數**：20 次。

# 每輪回報格式 (Report Format)
- **當前階段**：(分析中 / 設計中 / 實作中 / 除錯中)
- **策略/架構確認**：(請簡述目前的設計方向)
- **Antigravity 檢查**：(功能驗證結果)
- **下一步**：

# 完成條件 (Completion Promise)
僅當滿足以下所有條件時，輸出 `<promise>COMPLETE</promise>`：
1. MVP 核心功能經 Agent 實測可運作。
2. 敏感資訊皆已抽離至設定檔。

在輸出完成標記之前，不得宣告任務完成。
